<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="alternate" href="/atom.xml" title="彭领的博客" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="彭领的博客">
<meta property="og:url" content="http://www.pengling.cc/index.html">
<meta property="og:site_name" content="彭领的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="彭领的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.pengling.cc/"/>





  <title>彭领的博客</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">彭领的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/08/20/java-class-constant-pool/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/20/java-class-constant-pool/" itemprop="url">JVM系列（一）java 类文件结构</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-20T13:38:10+08:00">
                2017-08-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/java/" itemprop="url" rel="index">
                    <span itemprop="name">java</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="什么是class文件"><a href="#什么是class文件" class="headerlink" title="什么是class文件"></a>什么是class文件</h2><p>java 类文件即经过javac 编译后的文件，它的作用可以理解为用一种约定好的规则去描述一个类，jvm在拿到这个class文件后因为有了大家都知道的规则它就能解读理解这个类，比如这个类有哪些字段、有哪些方法、继承关系等等信息，就好像在阅读一本说明书一样。</p>
<p>因为这本说明书是给机器看的所以没有必要像人类的说明书一样有那么多空格换行注释，类文件是以字节为单位一个个紧密排列的二进制文件。</p>
<h2 id="class文件的结构"><a href="#class文件的结构" class="headerlink" title="class文件的结构"></a>class文件的结构</h2><p>class文件中特定位置字节所表示的含义是固定的，比如固定的前4个字节表示魔数，5~6字节表示次版本号，文件中只包含两种基本结构: <code>无符号数</code> 和 <code>表</code>，无符号数以u1、u2、u3、u4 表示1个字节、2个字节、3个字节、4个字节，而表就是由多个无符号数或者子表构成的一种复合结构类似结构体，一个表的前面紧跟的肯定是一个u2用来表示这个表的长度。</p>
<p>下面是类文件的具体结构，不急着看懂每一项的含义，只要先有个直观的感受，后面我们会结合一个实例去说，想象这个文件是一个个排列好的格子，有的大格子（表）里面可能还套着n个小的格子，这些一个个排在一起的格子就构成了我们的类文件。</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>名称</th>
<th>数量</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>u4</td>
<td>magic</td>
<td>1</td>
<td>魔数，用于表示这个文件是个class文件</td>
</tr>
<tr>
<td>u2</td>
<td>minor_version</td>
<td>1</td>
<td>次版本号</td>
</tr>
<tr>
<td>u2</td>
<td>major_version</td>
<td>1</td>
<td>主板本号</td>
</tr>
<tr>
<td>u2</td>
<td>constant_pool_count</td>
<td>1</td>
<td>常量池长度</td>
</tr>
<tr>
<td>cp_info</td>
<td>constant_pool</td>
<td>constant_pool_count - 1</td>
<td>常量池表</td>
</tr>
<tr>
<td>u2</td>
<td>access_flags</td>
<td>1</td>
<td>访问标志</td>
</tr>
<tr>
<td>u2</td>
<td>this_class</td>
<td>1</td>
<td>当前类在常量池中的索引位置</td>
</tr>
<tr>
<td>u2</td>
<td>super_class</td>
<td>1</td>
<td>父类在常量池中的索引位置</td>
</tr>
<tr>
<td>u2</td>
<td>interfaces_count</td>
<td>1</td>
<td>接口的数量</td>
</tr>
<tr>
<td>u2</td>
<td>interfaces</td>
<td>interfaces_count</td>
<td>接口表</td>
</tr>
<tr>
<td>u2</td>
<td>fields_count</td>
<td>1</td>
<td>字段的数量</td>
</tr>
<tr>
<td>field_info</td>
<td>fields</td>
<td>fields_count</td>
<td>字段表</td>
</tr>
<tr>
<td>u2</td>
<td>methods_count</td>
<td>1</td>
<td>方法的数量</td>
</tr>
<tr>
<td>method_info</td>
<td>methods</td>
<td>methods_count</td>
<td>方法表</td>
</tr>
<tr>
<td>u2</td>
<td>attribute_count</td>
<td>1</td>
<td>属性的数量</td>
</tr>
<tr>
<td>attribute_info</td>
<td>attributes</td>
<td>attributes_count</td>
<td>属性表</td>
</tr>
</tbody>
</table>
<p>前三个格子最简单分别表示魔数、次版本号、主版本号都是用无符号数去表示，这三个一共占了8个字节（4+2+2），这8个字节结束之后就碰到了第一个表结构也是最基础的一个表<code>常量池表</code>，首先是一个u2字段表示常量池有多少项，紧接着就开始了这个表中的真正内容。</p>
<p>简单的说常量池就是把类中的各种元素像积木一样拆成一堆小元素，这些小元素主要分为两种：<code>字面量</code> 和 <code>符号引用</code>，字面量最好理解比如我们类中写了一个整数32769那这个数就会出现在常量池中，符号引用呢则是用来指代一个类或者一个方法或者一个字段，具体的内容我们后续再说。再提醒一点注意的是，我们这里说的是class文件中的常量池，不是运行时常量池，不要搞混。</p>
<p>常量池表结束后是访问标志字段，这个字段是表示限定于整个类上的一些标识，比如这是个类还是接口、是不是public的、是不是abstract的等等。</p>
<p>再往后是this_class 和 super_class 字段 这两个字段，用于表示当前类的全类名 和 父类的全类名，但是你发现他们只是一个u2那怎么表示一个可能路径很深的类呢，其实这里存的只是常量池中的一个索引值，细节后续再说。</p>
<p>继续往后又是一个表结构接口表，表示这个类实现了哪些接口。</p>
<p>接着是字段表，用于描述这个类有哪些字段。</p>
<p>接着是方法表，用于描述这个类有哪些方法。</p>
<p>最后是属性表，这表相当类上的一些附加信息，我们可以把一些扩展字段放到这里面，比如一个包含内部类的类，就会在这个地方存放内部类的列表。</p>
<p>整体的结构就介绍完了，总结一下大致的结构顺序</p>
<blockquote>
<p>魔数 版本号  常量池  访问标志  当前类索引  父类索引 接口表 字段表 方法表 属性表</p>
</blockquote>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><p>下面我们就利用javap来直观的感受一下的类结构</p>
<p>java类</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestClass</span> &#123;</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> anInt=<span class="number">888</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> otherInt=<span class="number">32769</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> String anString = <span class="string">"an string"</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">anFunction</span><span class="params">(<span class="keyword">int</span> anPam)</span></span>&#123;</div><div class="line">        Integer a = <span class="keyword">new</span> Integer(<span class="number">666</span>);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> a.intValue() + anPam + anInt;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>先用javac 编译这个类形成class文件，然后用javap查看编译后的类文件。</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">javac </span>TestClass.<span class="keyword">java </span></div><div class="line"><span class="keyword">javap </span>-v -p TestClass &gt; TestClass<span class="meta">.code</span></div></pre></td></tr></table></figure>
<p>先看下编译后的TestClass.class文件长什么样</p>
<p><img src="/media/15046186369105.jpg" alt=""></p>
<p>和前面介绍的一样，开始的一个u4是固定的魔数CAFEBABE， 紧跟的两个u2是次版本号主板本号，再后面是一个u2 0026转成10进制是38 表示常量池的长度是38，再往后就开始常量池、访问标志、类索引等等一系列的东西。</p>
<p>直接看二进制文件太反人类，我们用javap来解析出更易读结果（或者说反编译），输出的结果如下。</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line">Classfile /Users/leeco/code/java<span class="params">-gc</span>/src/TestClass.class</div><div class="line">  MD5 checksum <span class="number">28</span>eefbbb8c29faedb096e39a37a1db17</div><div class="line">  Compiled from <span class="string">"TestClass.java"</span></div><div class="line"><span class="keyword">public</span> class TestClass</div><div class="line">  minor version: <span class="number">0</span></div><div class="line">  major version: <span class="number">52</span></div><div class="line">  flags: ACC_PUBLIC, ACC_SUPER</div><div class="line">Constant pool:</div><div class="line">   #1 = Methodref          #11.#25        <span class="comment">// java/lang/Object."&lt;init&gt;":()V</span></div><div class="line">   #2 = Fieldref           #10.#26        <span class="comment">// TestClass.anInt:I</span></div><div class="line">   #3 = <span class="built_in">Integer</span>            <span class="number">32769</span></div><div class="line">   #4 = Fieldref           #10.#27        <span class="comment">// TestClass.otherInt:I</span></div><div class="line">   #5 = <span class="built_in">String</span>             #28            <span class="comment">// an string</span></div><div class="line">   #6 = Fieldref           #10.#29        <span class="comment">// TestClass.anString:Ljava/lang/String;</span></div><div class="line">   #7 = Class              #30            <span class="comment">// java/lang/Integer</span></div><div class="line">   #8 = Methodref          #7.#31         <span class="comment">// java/lang/Integer."&lt;init&gt;":(I)V</span></div><div class="line">   #9 = Methodref          #7.#32         <span class="comment">// java/lang/Integer.intValue:()I</span></div><div class="line">  #10 = Class              #33            <span class="comment">// TestClass</span></div><div class="line">  #11 = Class              #34            <span class="comment">// java/lang/Object</span></div><div class="line">  #12 = Utf8               anInt</div><div class="line">  #13 = Utf8               I</div><div class="line">  #14 = Utf8               otherInt</div><div class="line">  #15 = Utf8               anString</div><div class="line">  #16 = Utf8               Ljava/lang/<span class="built_in">String</span>;</div><div class="line">  #17 = Utf8               &lt;init&gt;</div><div class="line">  #18 = Utf8               ()V</div><div class="line">  #19 = Utf8               Code</div><div class="line">  #20 = Utf8               LineNumberTable</div><div class="line">  #21 = Utf8               anFunction</div><div class="line">  #22 = Utf8               (I)I</div><div class="line">  #23 = Utf8               SourceFile</div><div class="line">  #24 = Utf8               TestClass.java</div><div class="line">  #25 = NameAndType        #17:#18        <span class="comment">// "&lt;init&gt;":()V</span></div><div class="line">  #26 = NameAndType        #12:#13        <span class="comment">// anInt:I</span></div><div class="line">  #27 = NameAndType        #14:#13        <span class="comment">// otherInt:I</span></div><div class="line">  #28 = Utf8               an <span class="built_in">string</span></div><div class="line">  #29 = NameAndType        #15:#16        <span class="comment">// anString:Ljava/lang/String;</span></div><div class="line">  #30 = Utf8               java/lang/<span class="built_in">Integer</span></div><div class="line">  #31 = NameAndType        #17:#35        <span class="comment">// "&lt;init&gt;":(I)V</span></div><div class="line">  #32 = NameAndType        #36:#37        <span class="comment">// intValue:()I</span></div><div class="line">  #33 = Utf8               TestClass</div><div class="line">  #34 = Utf8               java/lang/Object</div><div class="line">  #35 = Utf8               (I)V</div><div class="line">  #36 = Utf8               intValue</div><div class="line">  #37 = Utf8               ()I</div><div class="line">&#123;</div><div class="line">  <span class="keyword">public</span> int anInt;</div><div class="line">    descriptor: I</div><div class="line">    flags: ACC_PUBLIC</div><div class="line"></div><div class="line">  <span class="keyword">public</span> int otherInt;</div><div class="line">    descriptor: I</div><div class="line">    flags: ACC_PUBLIC</div><div class="line"></div><div class="line">  <span class="keyword">public</span> java.lang.<span class="built_in">String</span> anString;</div><div class="line">    descriptor: Ljava/lang/<span class="built_in">String</span>;</div><div class="line">    flags: ACC_PUBLIC</div><div class="line"></div><div class="line">  <span class="keyword">public</span> TestClass();</div><div class="line">    descriptor: ()V</div><div class="line">    flags: ACC_PUBLIC</div><div class="line">    Code:</div><div class="line">      <span class="built_in">stack</span>=<span class="number">2</span>, locals=<span class="number">1</span>, args_size=<span class="number">1</span></div><div class="line">         <span class="number">0</span>: aload_0</div><div class="line">         <span class="number">1</span>: invokespecial #1                  <span class="comment">// Method java/lang/Object."&lt;init&gt;":()V</span></div><div class="line">         <span class="number">4</span>: aload_0</div><div class="line">         <span class="number">5</span>: sipush        <span class="number">888</span></div><div class="line">         <span class="number">8</span>: putfield      #2                  <span class="comment">// Field anInt:I</span></div><div class="line">        <span class="number">11</span>: aload_0</div><div class="line">        <span class="number">12</span>: ldc           #3                  <span class="comment">// int 32769</span></div><div class="line">        <span class="number">14</span>: putfield      #4                  <span class="comment">// Field otherInt:I</span></div><div class="line">        <span class="number">17</span>: aload_0</div><div class="line">        <span class="number">18</span>: ldc           #5                  <span class="comment">// String an string</span></div><div class="line">        <span class="number">20</span>: putfield      #6                  <span class="comment">// Field anString:Ljava/lang/String;</span></div><div class="line">        <span class="number">23</span>: <span class="keyword">return</span></div><div class="line">      LineNumberTable:</div><div class="line">        line <span class="number">1</span>: <span class="number">0</span></div><div class="line">        line <span class="number">2</span>: <span class="number">4</span></div><div class="line">        line <span class="number">4</span>: <span class="number">11</span></div><div class="line">        line <span class="number">6</span>: <span class="number">17</span></div><div class="line"></div><div class="line">  <span class="keyword">public</span> int anFunction(int);</div><div class="line">    descriptor: (I)I</div><div class="line">    flags: ACC_PUBLIC</div><div class="line">    Code:</div><div class="line">      <span class="built_in">stack</span>=<span class="number">3</span>, locals=<span class="number">3</span>, args_size=<span class="number">2</span></div><div class="line">         <span class="number">0</span>: <span class="literal">new</span>           #7                  <span class="comment">// class java/lang/Integer</span></div><div class="line">         <span class="number">3</span>: dup</div><div class="line">         <span class="number">4</span>: sipush        <span class="number">666</span></div><div class="line">         <span class="number">7</span>: invokespecial #8                  <span class="comment">// Method java/lang/Integer."&lt;init&gt;":(I)V</span></div><div class="line">        <span class="number">10</span>: astore_2</div><div class="line">        <span class="number">11</span>: aload_2</div><div class="line">        <span class="number">12</span>: invokevirtual #9                  <span class="comment">// Method java/lang/Integer.intValue:()I</span></div><div class="line">        <span class="number">15</span>: iload_1</div><div class="line">        <span class="number">16</span>: iadd</div><div class="line">        <span class="number">17</span>: aload_0</div><div class="line">        <span class="number">18</span>: getfield      #2                  <span class="comment">// Field anInt:I</span></div><div class="line">        <span class="number">21</span>: iadd</div><div class="line">        <span class="number">22</span>: ireturn</div><div class="line">      LineNumberTable:</div><div class="line">        line <span class="number">9</span>: <span class="number">0</span></div><div class="line">        line <span class="number">11</span>: <span class="number">11</span></div><div class="line">&#125;</div><div class="line">SourceFile: <span class="string">"TestClass.java"</span></div></pre></td></tr></table></figure>
<p>别被吓到，我们不用去深究这个输出的细节，先大体的知道每一块表示的意思即可。</p>
<p>首先最重要的一块 Constant pool， 常量池，我们简单的看下它，这个常量池的第一项（#1 = Methodref   #11.#25）是个方法的符号引用，一看就明白代表Object 的无参数默认实例化方法，至于那串奇怪的java/lang/Object.”<init>“:()V 是什么我们后面再说现在大概知道他是指代一个方法的引用即可，第二项呢（#2 = Fieldref    #10.#26）是一个字段的符号引用对应我们代码中的anInt这个变量，第三项呢就是一个字面量32769，第四项呢是一个字符串的符号引用可以看到他是引用的第28项，我们看下第28项呢是一个Utf8类型的字面量内容正是我们定义的<code>an string</code>，好了其他的我们先不去深究 ，你能感觉出来编译器把我们类中的关键信息都拆解了出来放到了常量池，你可能会说这样啰嗦的定义是搞甚?我的理解一是为了节省空间二是有个统筹管理的地方，把一些共用的东西都尽量抽出来，其实有点像我们自己在写程序中定义的一些常量，我们不也是把程序中多次用到的一些值抽出来定义成一个常量。</init></p>
<p>另一块，属性表，不多说，能看出来我们定义的三个属性。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">int</span> anInt;</div><div class="line">    descriptor: I</div><div class="line">    flags: ACC_PUBLIC</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keyword">int</span> otherInt;</div><div class="line">    descriptor: I</div><div class="line">    flags: ACC_PUBLIC</div><div class="line"></div><div class="line">  <span class="keyword">public</span> java.lang.<span class="keyword">String</span> anString;</div><div class="line">    descriptor: Ljava/lang/<span class="keyword">String</span>;</div><div class="line">    flags: ACC_PUBLIC</div></pre></td></tr></table></figure>
<p>最后一大块，方法表，可以看到两个方法，一个是自动生成无参数数，一个是我们定义的anFunction方法， 方法里面有个很重要的属性<code>Code</code>，没错它就表示了我们在方法中书写的代码逻辑，里面的每一行都是一个字节码指令。<br>对照我们定义的方法，我们简单看下这些字节码是啥。</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="built_in">int</span> anFunction(<span class="built_in">int</span> anPam)&#123;</div><div class="line">        <span class="keyword">Integer</span> a = new <span class="keyword">Integer</span>(<span class="number">666</span>);</div><div class="line">        <span class="keyword">return</span> a.intValue() + anPam + <span class="built_in">anInt</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight http"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"> <span class="attribute">0</span>: new           #7    // class java/lang/Integer</div><div class="line"> <span class="attribute">3</span>: dup</div><div class="line"> <span class="attribute">4</span>: sipush        666</div><div class="line"> <span class="attribute">7</span>: invokespecial #8    // Method java/lang/Integer."&lt;init&gt;":(I)V</div><div class="line"><span class="attribute">10</span>: astore_2</div><div class="line"><span class="attribute">11</span>: aload_2</div><div class="line"><span class="attribute">12</span>: invokevirtual #9    // Method java/lang/Integer.intValue:()I</div><div class="line"><span class="attribute">15</span>: iload_1</div><div class="line"><span class="attribute">16</span>: iadd</div><div class="line"><span class="attribute">17</span>: aload_0</div><div class="line"><span class="attribute">18</span>: getfield      #2    // Field anInt:I</div><div class="line"><span class="attribute">21</span>: iadd</div><div class="line"><span class="attribute">22</span>: ireturn</div></pre></td></tr></table></figure>
<p>具体的指令不用死记硬背用到时查手册，从这个例子中弄明白什么是基于栈的操作才是最重要的，简单说在调用一个方法之前必须为这个方法在操作数栈中准备好它需要的一些值，这里会涉及到局部变量表，操作数栈，堆这些概念不理解也没关系，我们下一节细说。</p>
<ol>
<li><p>new #7  ，new 是指令 #7是参数表示常量池中的第7个元素，我们看到#7里存的是java/lang/Integer这个类的符号引用，合起来的意思就是new 一个Integer对象出来到堆里并把这个new出来的实例的引用压入操作数栈顶（操作数栈顶是什么我们后面将，这里先简单知道字节码的操作是基于栈的），这句执行完之后内存中就已经有个新的Integer对象，但是注意这时候对象中字段的值还都是0值，因为还没调用构造函数进行对象的初始化。</p>
</li>
<li><p>dup 复制刚才我们new出来的对象引用，并压入操作数栈，此时我们的操作数栈有了两个对那个Integer实例的引用</p>
</li>
<li>sipush 666, 把666这个字面量压入到栈顶，此时我们的操作数栈里面有个三个值</li>
<li>invokespecial #8 调用Integer类的构造函数，他会消耗掉我们栈中的两个值，一个是字面量666，一个是新对象的符号引用，方法调用完会把方法的返回值压入到我们当前的操作数栈帧，这个时候我们的栈帧中还剩一个符号引用指向那个Integer实例,说到方法调用这里提一句，即使是调用自己所在类的方法，也是要通过符号引用的。</li>
<li>astore_2 将操作数栈中的第一个元素弹出，并存入到局部变量表的第2个位置，即存入 a 这个变量中，（第0个位置是当前对象，第1个位置是函数参数anPam）,到这一步就完成了Integer a = new Integer(666); 这个语句的全部操作。到此时我们的栈里面就空了。</li>
<li>aload_2 还记得前面说过调用一个函数前必须在操作数栈中为它准备好要用到的值，这一句的作用就是把第二个局部变量压入操作数栈</li>
<li>invokevirtual #9  开始调用Integer.intValue方法，并把返回的值压入栈顶，此时栈中又有了一个字面量 666</li>
<li>iload_1 把局部变量表的第一个值压入栈，此时栈中有了两个值一个666 另一个是参数anPam上存的值</li>
<li>iadd 弹出操作数栈中的两个值进行加法运算，把结果压回栈</li>
<li>aload_0 把这个方法所在的实例（this）的引用压入操作数栈</li>
<li>getfield      #2，弹出栈顶那个实例，取它一个字段的值，并把这个值压入操作数栈，具体取哪个字段有参数#2知道，我们查一下常量表发现#代表的是anInt 这个字段的引用。这个时候我们的操作数栈中有两个值一个是前面iadd的计算结果  一个是这里刚拿到的字段anInt的值</li>
<li>iadd 再次执行加法运算，并把结果压回操作数栈，此时操作数栈中存放的值 就是a.intValue() + anPam + anInt 计算后的结果</li>
<li>ireturn 从当前方法返回栈顶的值</li>
</ol>
<p>我们可以看到简单的一个new操作其实是对应虚拟机中好几部的操作，包括分配内存，初始化内存，赋值给变量等等，当然这中间可能还隐藏了类的加载，符号引用解析成直接地址等等，这些我们后面再细说。</p>
<p>最后再补充一下我们说的这些字节码，此刻还都是躺在静态的文件里，还没被真正的执行，上面说的那一串东西都是描述假如这段代码被执行了是个什么效果。</p>
<p>##总结<br>到此应该对class文件是什么，有什么作用有了一个直观的感受，这个文件中的一些细节比如字段表的结构是怎么样的，函数的异常是定义在哪的，我们可以在用到的时候再去细究，下一节我们开始讨论之前提到的堆、操作数栈、局部变量表这些东西。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/08/09/laravel-summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/09/laravel-summary/" itemprop="url">laravel 知识点总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-09T21:00:50+08:00">
                2017-08-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="关键概念"><a href="#关键概念" class="headerlink" title="关键概念"></a>关键概念</h1><h2 id="Ioc容器"><a href="#Ioc容器" class="headerlink" title="Ioc容器"></a>Ioc容器</h2><p>官方解释</p>
<blockquote>
<p>Laravel 服务容器是一个用于管理类依赖和执行依赖注入的强大工具</p>
</blockquote>
<p>个人理解，容器就是一个大箱子，可以往里注册一个类（当然不限于类，也可以是php中任何的变量，后边统称为服务），也可以从里往外拿已经注册过的类，他提供了一个上下文的环境，我们运行的所有类都是来自于这个大箱子。<br>其最主要的方法是bind和make，bind是往箱子里塞东西即所谓的服务的绑定，make是从箱子里拿东西也就是所谓的服务的解析。</p>
<p>在代码中获取容器可以通过 帮助函数<code>app()</code> 也可以通过门面类<code>App</code>，但一般不用主动获取，我们需要的服务完全可以通过容器自动注入，例如在构造函数中进行注入。</p>
<h2 id="Facade模式"><a href="#Facade模式" class="headerlink" title="Facade模式"></a>Facade模式</h2><p>门面就是用来简化调用的，省去了我们从容器中获取服务的过程，门面就是一个静态代理，它通过<code>__callStatic()</code>方法代理容器中真正的服务。</p>
<h2 id="服务提供者"><a href="#服务提供者" class="headerlink" title="服务提供者"></a>服务提供者</h2><p><code>服务提供者</code>可以理解为不同类型服务的配置文件，也可以理解为载入服务的工具类，通过这个配置文件可以把服务注册到容器中（通过register方法，而register方法的主要作用就是调用容器的bind进行服务绑定），也可以对服务进行初始化（通过boot方法），容器会维护一个映射关系保存一个服务是由哪个<code>服务提供者</code>来进行注册的，服务提供者可以延迟载入容器（注意是服务提供者不是服务，提供者被延迟了它提供的服务当然也会被延迟绑定），是通过设置<code>$defer = true</code>并提供一个<code>provides</code>方法，这个方法会返回这个<code>服务提供者</code>所能提供的服务，方便容器去维护那个映射关系，当我们真正需要去使用一个延迟的服务的时候，容器就会根据映射关系先找到服务提供者，然后通过服务提供者把这个服务注册到容器。</p>
<h2 id="中间件"><a href="#中间件" class="headerlink" title="中间件"></a>中间件</h2><p>中间件就是处理流程中定义的一个个可插拔的处理环节，是管道模式的一种实现，中间件在<code>app/Http/Kernel</code>中配置，其中包括两类中间件 一类是全局中间件，即每个请求都会被应用这套处理，一类是路由中间件，只有匹配特定的路由的时候才会应用这些处理。关于管道模式参见 <a href="http://laravelacademy.org/post/3088.html" target="_blank" rel="external">这里</a></p>
<h1 id="请求的生命周期"><a href="#请求的生命周期" class="headerlink" title="请求的生命周期"></a>请求的生命周期</h1><h2 id="启动准备阶段"><a href="#启动准备阶段" class="headerlink" title="启动准备阶段"></a>启动准备阶段</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?php</span></span></div><div class="line"><span class="keyword">require</span> <span class="keyword">__DIR__</span>.<span class="string">'/../bootstrap/autoload.php'</span>;</div><div class="line">$app = <span class="keyword">require_once</span> <span class="keyword">__DIR__</span>.<span class="string">'/../bootstrap/app.php'</span>;</div><div class="line">$kernel = $app-&gt;make(Illuminate\Contracts\Http\Kernel::class);</div><div class="line">$response = $kernel-&gt;handle($request = Illuminate\Http\Request::capture());</div><div class="line">$response-&gt;send();</div><div class="line">$kernel-&gt;terminate($request, $response);</div></pre></td></tr></table></figure>
<p>请求到达index.php后首先载入自动加载文件autoload.php实现类的自动加载。<br>然后通过<code>bootstrap/app.php</code> 实例化容器<code>Application</code>，得到容器的实例<code>$app</code>，容器在初始化的时候会做几件事，会将自身的引用也注册入容器，方便后续程序调取，会注册两个基础服务提供者<code>EventServiceProvider</code> 和<code>RoutingServiceProvider</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;?php</div><div class="line">$app = new Illuminate\Foundation\Application(</div><div class="line">    realpath(__DIR_<span class="number">_</span>.<span class="string">'/../'</span>)</div><div class="line">);</div><div class="line">$app-&gt;singleton(</div><div class="line">    Illuminate\Contracts\Http\Kernel::<span class="class"><span class="keyword">class</span>,</span></div><div class="line">    App\Http\Kernel::<span class="class"><span class="keyword">class</span></span></div><div class="line">);</div><div class="line">$app-&gt;singleton(</div><div class="line">    Illuminate\Contracts\Console\Kernel::<span class="class"><span class="keyword">class</span>,</span></div><div class="line">    App\Console\Kernel::<span class="class"><span class="keyword">class</span></span></div><div class="line">);</div><div class="line">$app-&gt;singleton(</div><div class="line">    Illuminate\Contracts\Debug\ExceptionHandler::<span class="class"><span class="keyword">class</span>,</span></div><div class="line">    App\Exceptions\Handler::<span class="class"><span class="keyword">class</span></span></div><div class="line">);</div><div class="line"><span class="keyword">return</span> $app;</div></pre></td></tr></table></figure>
<p>接着从容器中取出Http\Kernel类 ，此类主要负责初始化环境以及调度各种服务完成一个http的处理流程 主要括中间件处理-&gt; 路由处理-&gt;控制器执行一系列的流程，是所有http处理的核心，类似linux的内核功能。</p>
<h2 id="请求实例化"><a href="#请求实例化" class="headerlink" title="请求实例化"></a>请求实例化</h2><p><code>$request = Illuminate\Http\Request::capture()</code>，将请求相关信息封装到<code>Request</code>类中</p>
<h2 id="请求处理"><a href="#请求处理" class="headerlink" title="请求处理"></a>请求处理</h2><p>进入到kernel的handle方法</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> $bootstrappers = [</div><div class="line">        \Illuminate\Foundation\Bootstrap\LoadEnvironmentVariables::class,</div><div class="line">        \Illuminate\Foundation\Bootstrap\LoadConfiguration::class,</div><div class="line">        \Illuminate\Foundation\Bootstrap\HandleExceptions::class,</div><div class="line">        \Illuminate\Foundation\Bootstrap\RegisterFacades::class,</div><div class="line">        \Illuminate\Foundation\Bootstrap\RegisterProviders::class,</div><div class="line">        \Illuminate\Foundation\Bootstrap\BootProviders::class,</div><div class="line">    ];</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">handle</span><span class="params">($request)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            $request-&gt;enableHttpMethodParameterOverride();</div><div class="line"></div><div class="line">            $response = <span class="keyword">$this</span>-&gt;sendRequestThroughRouter($request);</div><div class="line">        &#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;reportException($e);</div><div class="line"></div><div class="line">            $response = <span class="keyword">$this</span>-&gt;renderException($request, $e);</div><div class="line">        &#125; <span class="keyword">catch</span> (Throwable $e) &#123;</div><div class="line">            <span class="keyword">$this</span>-&gt;reportException($e = <span class="keyword">new</span> FatalThrowableError($e));</div><div class="line"></div><div class="line">            $response = <span class="keyword">$this</span>-&gt;renderException($request, $e);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">$this</span>-&gt;app[<span class="string">'events'</span>]-&gt;dispatch(</div><div class="line">            <span class="keyword">new</span> Events\RequestHandled($request, $response)</div><div class="line">        );</div><div class="line"></div><div class="line">        <span class="keyword">return</span> $response;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>handle 中会首先完成环境的检测、配置文件的加载、门面类的注册、服务提供者的注册、服务初始化等一系列初始化工作。其中最重要的是载入服务提供者，即配置在<code>config/app.php</code>中的provider。</p>
<p>初始化完成后，通过<code>sendRequestThroughRouter</code>调用开始管道中的逐个中间件处理。</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Pipeline<span class="function"><span class="params">($<span class="keyword">this</span>-&gt;app)</span>)</span></div><div class="line">                    -&gt;send<span class="function"><span class="params">($request)</span></span></div><div class="line">                    -&gt;through<span class="function"><span class="params">($<span class="keyword">this</span>-&gt;app-&gt;shouldSkipMiddleware() ? [] : $<span class="keyword">this</span>-&gt;middleware)</span></span></div><div class="line">                    -&gt;<span class="keyword">then</span>($<span class="keyword">this</span>-&gt;dispatchToRouter()</div></pre></td></tr></table></figure>
<p>send 是发送到管道进行传递的对象，through是传递的过程，then是传递完成后的处理,注意在这里调用的是全局中间件。</p>
<h2 id="路由处理"><a href="#路由处理" class="headerlink" title="路由处理"></a>路由处理</h2><p>全局中间件处理完毕后就进入到路由处理，路由这里又执行了一个管道处理，就是下面的这段代码，这里执行的中间件就是匹配这个路由的<code>路由中间件</code>。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">runRouteWithinStack</span><span class="params">(Route $route, Request $request)</span></span></div><div class="line">    &#123;</div><div class="line">        $shouldSkipMiddleware = <span class="keyword">$this</span>-&gt;container-&gt;bound(<span class="string">'middleware.disable'</span>) &amp;&amp;</div><div class="line">                                <span class="keyword">$this</span>-&gt;container-&gt;make(<span class="string">'middleware.disable'</span>) === <span class="keyword">true</span>;</div><div class="line"></div><div class="line">        $middleware = $shouldSkipMiddleware ? [] : <span class="keyword">$this</span>-&gt;gatherRouteMiddleware($route);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> (<span class="keyword">new</span> Pipeline(<span class="keyword">$this</span>-&gt;container))</div><div class="line">                        -&gt;send($request)</div><div class="line">                        -&gt;through($middleware)</div><div class="line">                        -&gt;then(<span class="function"><span class="keyword">function</span> <span class="params">($request)</span> <span class="title">use</span> <span class="params">($route)</span> </span>&#123;</div><div class="line">                            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;prepareResponse(</div><div class="line">                                $request, $route-&gt;run()</div><div class="line">                            );</div><div class="line">                        &#125;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h2 id="执行控制器"><a href="#执行控制器" class="headerlink" title="执行控制器"></a>执行控制器</h2><p>管道处理的最后会交给<code>$route-&gt;run()</code>方法，开始调用我们写的控制器。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;container = <span class="keyword">$this</span>-&gt;container ?: <span class="keyword">new</span> Container;</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="keyword">$this</span>-&gt;isControllerAction()) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;runController();</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;runCallable();</div><div class="line">        &#125; <span class="keyword">catch</span> (HttpResponseException $e) &#123;</div><div class="line">            <span class="keyword">return</span> $e-&gt;getResponse();</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>控制器执行完成后返回<code>Response</code>对象，控制权转回给Kernel开始对这个Response执行发送处理，最后执行终止处理调用中间件的<code>terminate</code>方法 ，完成整个生命周期。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/08/04/mac-config-xdebug/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/04/mac-config-xdebug/" itemprop="url">mac 环境配置xdebug 到phpstorm</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-04T18:03:06+08:00">
                2017-08-04
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本文的前置条件是使用brew安装php环境，其他方式请避让</p>
<h2 id="安装xdebug扩展"><a href="#安装xdebug扩展" class="headerlink" title="安装xdebug扩展"></a>安装xdebug扩展</h2><p><code>brew install php56-xdebug</code> 安装完成后查看<code>brew info php56-xdebug</code> 查看xdebug配置文件路径 我的路径是<code>/usr/local/etc/php/5.6/conf.d/ext-xdebug.ini</code></p>
<p>修改这个配置文件 增加远程调用的支持</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">xdebug<span class="selector-class">.remote_enable</span> = On</div><div class="line">xdebug<span class="selector-class">.remote_port</span> = <span class="number">9004</span></div></pre></td></tr></table></figure>
<p><strong>注意</strong>这里的端口 不能和php-fpm的重复 所以改为9000之外的其他端口</p>
<p>重启php-fpm <code>brew services restart php56</code></p>
<p>运行phpinfo查看 xdebug是否配置正确</p>
<h2 id="配置-phpstorm"><a href="#配置-phpstorm" class="headerlink" title="配置 phpstorm"></a>配置 phpstorm</h2><p>Phpstrom–&gt; Preferences.. 找到php选项，配置cli地址<br><img src="media/15018418358978.jpg" alt=""></p>
<p><img src="media/15018418757327.jpg" alt=""></p>
<p>再找到php文件夹下的debug配置xdebug的端口，注意要和ini文件中配置的一致才能远程调试</p>
<p><img src="media/15018420640780.jpg" alt=""></p>
<h2 id="创建Debug配置"><a href="#创建Debug配置" class="headerlink" title="创建Debug配置"></a>创建Debug配置</h2><p>可以远程调试的前提是 已经配置好了nginx或其他服务器 可以用本地ip访问到你的php页面</p>
<p>增加调试配置<br><img src="media/15018442278043.jpg" alt=""></p>
<p>增加一个web application 配置，serverc处点击更多，配置本地的服务器地址和端口<br><img src="media/15018443219352.jpg" alt=""></p>
<p>至此配置完毕 可以点击绿臭虫图标开始断点调试</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/08/03/mac-install-php-extension-by-source/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/03/mac-install-php-extension-by-source/" itemprop="url">mac 下通过源码安装php扩展</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-03T15:40:25+08:00">
                2017-08-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="安装源码包中存在的扩展"><a href="#安装源码包中存在的扩展" class="headerlink" title="安装源码包中存在的扩展"></a>安装源码包中存在的扩展</h1><p>以openssl为例进行安装 其他扩展类似</p>
<h2 id="下载源码"><a href="#下载源码" class="headerlink" title="下载源码"></a>下载源码</h2><ul>
<li>下载<code>git clone git@github.com:php/php-src.git</code></li>
<li>执行<code>git tag | grep 5.6.0</code>找到需要的源码版本例如<code>php-5.6.0</code>，并切到此tag下<code>git checkout php-5.6.0</code></li>
</ul>
<h2 id="执行phpize"><a href="#执行phpize" class="headerlink" title="执行phpize"></a>执行phpize</h2><p>进入到扩展目录<code>ext/openssl</code>执行<code>phpize</code> 提示找不到config.m4 这个文件，解决办法<code>mv config0.m4 config.m4</code> 后，继续执行phpize 通过</p>
<h2 id="执行configure"><a href="#执行configure" class="headerlink" title="执行configure"></a>执行configure</h2><p><code>./configure --with-php-config=/usr/local/bin/php-config</code> 报错提示找不到openssl头文件 <code>Cannot find OpenSSL&#39;s &lt;evp.h&gt;</code>,</p>
<p>解决方案<code>./configure --with-php-config=/usr/local/bin/php-config --with-openssl=/usr/local/opt/openssl</code></p>
<p>分析过程：</p>
<ol>
<li>首先尝试安装openssl，<code>brew install openssl</code> 安装后configure依然不能通过</li>
<li>brew info openssl 查看安装信息，发现文末有这么一句提示<img src="media/15017479570718.jpg" alt=""></li>
<li>尝试指定安装目录<code>./configure --with-php-config=/usr/local/bin/php-config --with-openssl=/usr/local/opt/openssl</code> 成功</li>
</ol>
<p>##编译安装so文件<br><code>make &amp;&amp; make install</code><br><img src="media/15017484579095.jpg" alt=""><br>用<code>php --info | grep php.ini</code>找到你的<code>php.ini</code>文件<br>在配置文件中添加<code>extension=openssl.so</code></p>
<p><code>php -m|grep openssl</code>确认扩展已经安装<br>如果是php-fpm 重启php-fpm</p>
<h1 id="补充-如何用brew-安装php"><a href="#补充-如何用brew-安装php" class="headerlink" title="补充-如何用brew 安装php"></a>补充-如何用brew 安装php</h1><p>官方的brew库里没有php需要先扩展brew的安装库<br><code>brew tap homebrew/php</code><br>然后执行 <code>brew install --without-apache --with-fpm --with-mysql php56</code><br>把新安装的php加入到系统路径<br><code>echo &#39;export PATH=&quot;$(brew --prefix homebrew/php/php56)/bin:$PATH&quot;&#39; &gt;&gt; ~/.zshrc</code> 注意我用zsh所有是.zshrc</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/07/26/mysql-summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/26/mysql-summary/" itemprop="url">mysql 知识点总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-26T23:57:39+08:00">
                2017-07-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mysql/" itemprop="url" rel="index">
                    <span itemprop="name">mysql</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="范式"><a href="#范式" class="headerlink" title="范式"></a>范式</h1><ul>
<li>第一范式，所有字段都是原子性不可再拆解的</li>
<li>第二范式，主键字段之外的字段都完全依赖主键，不能部分依赖主键</li>
<li>第三范式，字段对主键的依赖必须是直接依赖，不能是传递依赖</li>
</ul>
<p>第二范式只有在组合主键的情况下才会出现，举例，订单条目表（订单id，商品id，商品数量，商品价格），订单id和商品id组合成为主键，但是商品价格只依赖于商品id，与订单id并没有直接的关系因此这样的表就不符合第二范式，商品价格属于冗余字段</p>
<p>第三范式标识虽然在主键确定后其他属性的值也确定了但是却不是直接确定的而是经过了一步或多不的跳转，即主键 确定了属性A 属性A 又确定了属性B，这种情况就是违反第三范式的，举例，商品表（商品id，商品名，商品价格，分类id，分类名）其中商品id是主键，虽然知道了商品id能确定分类名是什么，但其实不是直接确定的，而是经过 商品-&gt;分类-&gt;分类名这样跳了一步 因此这样的表不符合第三范式</p>
<h1 id="隔离级别"><a href="#隔离级别" class="headerlink" title="隔离级别"></a>隔离级别</h1><ul>
<li>未提交读</li>
<li>已提交读</li>
<li>可重复读</li>
<li>串行化</li>
</ul>
<p><img src="media/15010870833183.jpg" alt=""></p>
<ul>
<li>未提交读(Read Uncommitted)：允许脏读，也就是可能读取到其他会话中未提交事务修改的数据</li>
<li>提交读(Read Committed)：只能读取到已经提交的数据。Oracle等多数数据库默认都是该级别 (不重复读)</li>
<li>可重复读(Repeated Read)：可重复读。在同一个事务内的查询都是事务开始时刻一致的，InnoDB默认级别。在SQL标准中，该隔离级别消除了不可重复读，但是还存在幻象读</li>
<li>串行读(Serializable)：完全串行化的读，每次读都需要获得表级共享锁，读写相互都会阻塞</li>
</ul>
<p>可重复读 是针对update来说的，即我每次同样select都得到同样的结果，只要我自己不更新，哪怕是别的事务更新了我看到的数据也不会有变化，通俗的说就是排除了外界的干扰。</p>
<p>幻读 是针对insert来说的，比如我原来的where条件是 where a&gt;1 and a&lt;5 查出来了3条数据 1，2，3，这时候在我第二次执行这个查询的间隙，有别人执行了插入操作把 4 个插入进来了 ，第二次查询的结果就变成了1，2，3，4 这时候就叫出现了幻读，给行加锁没法阻止幻读，要给行间隙也加锁。</p>
<h1 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h1><p>数据库采用两段锁协议，即将事务分为加锁阶段和解锁阶段。</p>
<ul>
<li>在加锁阶段，读操作会申请共享锁(S锁)，写操作会申请排他锁（X锁），如果锁申请不成功则整个事务阻塞等待。</li>
<li>在解锁阶段事务开始释放锁，此时不能再重新的申请锁。</li>
</ul>
<h3 id="关于行锁"><a href="#关于行锁" class="headerlink" title="关于行锁"></a>关于行锁</h3><p>innodb的行锁，如果能利用到索引即在存储引擎层就能确定锁定的范围那么就会锁定指定的行，但是如果没有利用到所以那么存储引擎会先锁住整个表，然后返回给服务器层，服务器层再根据where条件通知存储引擎去释放没必要的锁。</p>
<h3 id="不同隔离级别的锁"><a href="#不同隔离级别的锁" class="headerlink" title="不同隔离级别的锁"></a>不同隔离级别的锁</h3><p>虽然有四个隔离级别但是 未提交读和串行化一般是不开启的，因此我们只关注<code>提交读</code>和<code>可重复读</code>即可。</p>
<p>在提交读级别（RC），读取数据是不加锁的，但是变动数据时要加锁，因为读没有加锁，所以会产生不可重复读和幻读。</p>
<p>在可重复读级别（RR），mysql 采用MVCC（多版本并发控制，可以看成一种乐观锁）来实现可重复读，来实现可重复读 和 解决幻读</p>
<p>在序列化这个级别，读加共享锁，写加排他锁。</p>
<h2 id="MVCC"><a href="#MVCC" class="headerlink" title="MVCC"></a>MVCC</h2><p>innodb 会给每行数据添加两个隐藏的版本号，一个是创建版本号，一个是删除版本号，每一个事务都会有一个递增的版本号，行上面的两个版本号就是来自于事务。</p>
<ul>
<li>SELECT时，读取创建版本号&lt;=当前事务版本号，删除版本号为空或&gt;当前事务版本号（含义是找到自己事务开始时就已经创建，并且还没有被删除的数据）。</li>
<li>INSERT时，保存当前事务版本号为行的创建版本号</li>
<li>DELETE时，保存当前事务版本号为行的删除版本号（注意这一行数据还在，类似假删除）</li>
<li>UPDATE时，插入一条新纪录，保存当前事务版本号为行创建版本号，同时保存当前事务版本号到原来删除的行（标记一个修改的时间点）</li>
</ul>
<p>举例A事务的版本号是1，它先创建了一条id=99的数据，然后读取where id=99这条记录 那么他的隐含查询条件是 where id=99 and create_version &lt;=1 and (delete_version = null or delete_version &gt; =1)<br>这时候如果版本号是2的事务B修改数据1 那么id=99的数据就会出现两条，一条是create_version = 2 delete_version = null的最新数据 一条是create_version = 1 delete_version = 2的历史数据。</p>
<p>以上关于MVCC的解释是不准确的，但是只最容易理解的，详细的解释见 <a href="http://www.imooc.com/article/17290" target="_blank" rel="external">http://www.imooc.com/article/17290</a></p>
<h2 id="常用查询函数"><a href="#常用查询函数" class="headerlink" title="常用查询函数"></a>常用查询函数</h2><h3 id="字符串函数"><a href="#字符串函数" class="headerlink" title="字符串函数"></a>字符串函数</h3><ul>
<li>select concat(file1,file2,file3); 链接字符串</li>
<li>select left(file1,3);取file1的最左边三个字符</li>
<li>select replace(file1,’aaa’,’bbb’);字符串替换</li>
</ul>
<h3 id="时间函数"><a href="#时间函数" class="headerlink" title="时间函数"></a>时间函数</h3><ul>
<li>select unix_timestamp(‘2017-08-03’); 返回时间戳</li>
<li>select from_unixtime(1501689600);返回日期</li>
</ul>
<h2 id="数据库状态查看"><a href="#数据库状态查看" class="headerlink" title="数据库状态查看"></a>数据库状态查看</h2><ul>
<li>show engines 查看数据库支持的引擎</li>
<li>show status 数据库统计信息<ul>
<li><code>show status like &#39;Com_select&#39;</code> 统计查询次数</li>
<li><code>show status like &#39;Com_select&#39;</code> 统计查询次数</li>
</ul>
</li>
<li>show index from table1</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/07/26/shell-find-and-replace/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/26/shell-find-and-replace/" itemprop="url">shell 中的查找替换</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-26T15:56:39+08:00">
                2017-07-26
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/shell/" itemprop="url" rel="index">
                    <span itemprop="name">shell</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>用sed实现多文本内容替换</li>
</ul>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sed -i <span class="string">'s/abc/ABC/g'</span> `grep -rl <span class="string">'abc'</span> /usr/local/`</div></pre></td></tr></table></figure>
<p>其中<code>grep -l</code>的作用是只显示文件路径 不显示其他内容 方便传递给sed</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/07/24/http-protocol/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/24/http-protocol/" itemprop="url">http 知识点总结</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-24T18:20:57+08:00">
                2017-07-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/网络/" itemprop="url" rel="index">
                    <span itemprop="name">网络</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="格式"><a href="#格式" class="headerlink" title="格式"></a>格式</h1><p>HTTP报文 由 <code>报文头部</code> 和 <code>报文主体</code> 组成，两者用CRLF（\r\n）分割<br>报文头部 包括 请求行（请求） 或 状态行（响应）、首部字段、和其他（例如cookie）<br>首部字段也是用CRLF分割</p>
<h1 id="常用错误码"><a href="#常用错误码" class="headerlink" title="常用错误码"></a>常用错误码</h1><ul>
<li>301 永久跳转</li>
<li>302 临时跳转</li>
<li>304 文件未修改</li>
<li>400 请求语法错误</li>
<li>402 请求未授权</li>
<li>403 禁止访问</li>
<li>503 服务不可用</li>
</ul>
<h1 id="长连接（keep-alive）"><a href="#长连接（keep-alive）" class="headerlink" title="长连接（keep-alive）"></a>长连接（keep-alive）</h1><p>TCP链接建立需要三次握手，传输完数据又需要四次握手，如果每传输一次数据就建立一个tcp链接那是十分浪费资源的，为了能更高效的利用tcp链接在HTTP/1.0 中提出了<code>Connection: keep-alive</code>（在HTTP/1.1中这是个默认选项，不在需要客户端显示发送，能否启用该功能取决于服务端设定）,作用是当一块数据发送完之后不会关闭链接，而是等待后续的tcp请求，注意这里是等待tcp而不是等待后续的http，因为即使用了keep-alive 一个tcp链接也是只能处理一个http的请求响应的。而keep-alive带出的一个问题是接收数据的一端（一般是浏览器）如何判断这个链接的数据已经发送完了。有两种办法 一种是服务端在这次请求中事先就告诉客户端内容的长度即设置 <code>Content-Length:</code>头，比如<code>Content-Length:100</code> 那么客户端在收到第一百个字节的时候（指报文主体长度）就关闭链接，另一种是下面介绍的<code>分块传输</code></p>
<h1 id="分块传输-Transfer-Encoding-chunked"><a href="#分块传输-Transfer-Encoding-chunked" class="headerlink" title="分块传输(Transfer-Encoding: chunked)"></a>分块传输(Transfer-Encoding: chunked)</h1><p>分块编码主要应用于如下场景，即要传输大量的数据，但是在请求在没有被处理完之前响应的长度是无法获得的，服务器无法预先知道<code>Content-Length</code>，这时候就可以在http头部设定<code>Transfer-Encoding: chunked</code> 告诉客户端我后面的数据是分块传输的，而每一块数据包括16进制的长度和真正的数据,而最后一个块必须是一个长度为0的块表示结束，客户端收到这个这个长度为0的块就可以发起<code>FIN</code>请求关闭链接了，更详细参见<a href="https://imququ.com/post/transfer-encoding-header-in-http.html" target="_blank" rel="external">这里</a></p>
<figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">HTTP/1.1 200 OK<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line">Transfer-Encoding: chunked<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line"><span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line"></div><div class="line">b<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line">01234567890<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line"></div><div class="line">5<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line">12345<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line"></div><div class="line">0<span class="symbol">\r</span><span class="symbol">\n</span></div><div class="line"><span class="symbol">\r</span><span class="symbol">\n</span></div></pre></td></tr></table></figure>
<h1 id="Cache-Control-缓存处理策略"><a href="#Cache-Control-缓存处理策略" class="headerlink" title="Cache-Control 缓存处理策略"></a>Cache-Control 缓存处理策略</h1><table>
<thead>
<tr>
<th>值</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>public</td>
<td>代理服务器和客户端都可缓存</td>
</tr>
<tr>
<td>private</td>
<td>仅客户端可以缓存</td>
</tr>
<tr>
<td>no-cache</td>
<td>请求头时表示不要缓存服务器的内容直接请求源服务器，响应头时表示浏览器每次必须先与服务器确认返回的响应是否被更改，然后才能使用该响应来满足后续对同一个网址的请求。</td>
</tr>
<tr>
<td>no-store</td>
<td>所有内容都不会被缓存到缓存或 Internet 临时文件中</td>
</tr>
<tr>
<td>must-revalidation/proxy-revalidation</td>
<td>如果缓存的内容失效，请求必须发送到服务器/代理以进行重新验证</td>
</tr>
<tr>
<td>max-age=xxx</td>
<td>请求头时表示只接受age小于这个值的缓存， 响应头时表示缓存的内容将在 xxx 秒后失效, 这个选项只在HTTP 1.1可用, 并如果和Last-Modified一起使用时, 优先级较高</td>
</tr>
</tbody>
</table>
<h1 id="常用头部"><a href="#常用头部" class="headerlink" title="常用头部"></a>常用头部</h1><h2 id="请求头"><a href="#请求头" class="headerlink" title="请求头"></a>请求头</h2><ul>
<li>Connection ： close告诉服务端请求完不要保持这个链接直接关闭，keep-alive 告诉服务端请求完别关闭链接 还有后续请求。</li>
<li>If-Modified-Since：如果请求的对象在该头部指定的时间之后修改了，才执行请求的动作（比如返回对象），否则返回代码304，告诉浏览器该对象没有修改。例如：If-Modified-Since：Thu, 10 Apr 2008 09:14:42 GMT</li>
<li>If-None-Match：如果对象的 ETag 改变了，其实也就意味著对象也改变了，才执行请求的动作。</li>
</ul>
<h2 id="响应头"><a href="#响应头" class="headerlink" title="响应头"></a>响应头</h2><ul>
<li>Cache-Control 缓存处理策略</li>
<li>Content-Encoding 压缩方式gzip</li>
<li>Content-Length 响应长度</li>
<li>Content-Type 内容的类型 application/xml</li>
<li>Transfer-Encoding 传输编码方式 目前只有chunked</li>
<li>ETag 响应内容的签名</li>
</ul>
<h1 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h1><h2 id="csrf-跨站请求伪造-防范"><a href="#csrf-跨站请求伪造-防范" class="headerlink" title="csrf 跨站请求伪造  防范"></a>csrf 跨站请求伪造  防范</h2><ul>
<li>判断referer</li>
<li>表单中加入随机token，并且每次表单提交后变换token</li>
</ul>
<h2 id="xss-跨站脚本攻击-防范"><a href="#xss-跨站脚本攻击-防范" class="headerlink" title="xss 跨站脚本攻击 防范"></a>xss 跨站脚本攻击 防范</h2><ul>
<li>过滤html java用spring的 HtmlUtils.htmlEscape php 用 htmlspecialchars</li>
<li>必须输入html的地方 设置标签白名单，解析html重新整理。</li>
</ul>
<h2 id="HTTPS流程"><a href="#HTTPS流程" class="headerlink" title="HTTPS流程"></a>HTTPS流程</h2><p><img src="media/15015587412678.jpg" alt=""></p>
<ol>
<li><p>客户端发送<code>ClientHello</code>请求到服务器，主要包括以下信息</p>
<blockquote>
<p>客户端协议的版本 如TLS 1.0<br>支持的加密算法 如RSA<br>支持的压缩算法<br>一个随机数（1）</p>
</blockquote>
</li>
<li><p>服务器回应<code>SeverHello</code>,包括以下信息</p>
<blockquote>
<p>确认加密协议版本 如TLS 1.0<br>确认加密算法<br>服务器整数<br>一个随机数（2）</p>
</blockquote>
</li>
<li><p>客户端验证证书的有效性，提取证书中的公钥，回复下面三个信息</p>
<blockquote>
<p>用证书中的公钥加密一个 随机数（3）这个随机数也成为 pre-master key<br>编码改变通知，表示随后用加密方式通信<br>客户端握手结束通知</p>
</blockquote>
</li>
<li><p>最后客户端回复确认消息包括</p>
<blockquote>
<p>编码改变通知<br>服务器握手结束通知  </p>
</blockquote>
</li>
</ol>
<p>TLS 详细说明 <a href="https://imququ.com/post/optimize-tls-handshake.html" target="_blank" rel="external">https://imququ.com/post/optimize-tls-handshake.html</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2017/07/21/longest-subtring-without-repeat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/21/longest-subtring-without-repeat/" itemprop="url">longest substring without repeat</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-21T19:55:57+08:00">
                2017-07-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/算法/" itemprop="url" rel="index">
                    <span itemprop="name">算法</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>Given a string, find the length of the longest substring without repeating characters.</p>
<p>Examples:</p>
<p>Given “abcabcbb”, the answer is “abc”, which the length is 3.</p>
<p>Given “bbbbb”, the answer is “b”, with the length of 1.</p>
<p>Given “pwwkew”, the answer is “wke”, with the length of 3. Note that the answer must be a substring, “pwke” is a subsequence and not a substring.</p>
</blockquote>
<h2 id="获取一个字符串中无重复字符的最长字符串"><a href="#获取一个字符串中无重复字符的最长字符串" class="headerlink" title="获取一个字符串中无重复字符的最长字符串"></a>获取一个字符串中无重复字符的最长字符串</h2><pre><code>public class Solution {
    public int lengthOfLongestSubstring(String s) {
        HashMap&lt;Character,Integer&gt; map = new HashMap&lt;&gt;();
        int max = 0;
        int j = 0;
        for(int i = 0;i&lt;s.length();i++){
            Character c = s.charAt(i);
            if(map.containsKey(c)){
                j = Math.max(map.get(c)+1,j);
            }
            map.put(c,i);
            max = Math.max(max,i-j+1);
        }
        return max;
    }
}
</code></pre><h1 id="解析："><a href="#解析：" class="headerlink" title="解析："></a>解析：</h1><p>‘fabcdaf’ 字符串从0开始编号<br>    可以想象手握一根线的两头在字符串间游走，不断去丈量寻找最大的长度，右手用<code>i</code>代表，左手用<code>j</code>去表示，<code>Hashmap</code>是我们的记账本，每个字母的位置我们都记录在本子上，同时<code>i</code>每走一步我们就算一次最大长度算法就是左右手间的距离也就是<code>i-j+1</code>（其实没有必要每次都算但是这样的代码最简洁），对于重复出现的字母我们只记录最新的。<br>    让<code>i</code>先往右走 即 <code>i++</code>，并把<code>i</code>碰到的字母和位置记录到本子中，重复这个过程，直到本子上第一次出现了重复的字母，我们看一下本子上这个字母的位置，比如<code>i</code>现在走到了<code>5</code>碰到了重复字母<code>a</code>，本子上记录的位置是<code>1</code>，这时候我们就要挪动左手了，因为两个手之间出现了重复的字符我们要把它跳过去，那把左手往哪挪呢？肯定是往右挪，挪到哪最合适呢？当然是紧挨着1号位的右手边二号位是最合适的，因此这时<code>j</code>的取值就变成了<code>map.get(c)+1</code>，好，到了最难理解的一步<code>Math.max</code>的作用，这时候它的作用还没发挥出来，我们接着让<code>i</code>往右走。<br>    此时的<code>j</code>停在了<code>2</code>号位,<code>i</code>走到了字符<code>f</code>,<code>i</code>又一次的从本子上发现了出现过的字母，又该动动你的左手了，往哪边挪？不能往左，因为往左会出现更多的重复（a的重复）只能往右或者原地不动，而因为<code>f</code>的位置比<code>a</code>还要靠左，那好看来原地不动是最好的选择，所以我们在<code>j</code>的取值上增加了一个max处理，就是防止左手又回到了一个错误的位置上。</p>
<h1 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h1><blockquote>
<p>i 和 j 这两个指针是只能往右走的 不能走回头路，i负责探路，j负责跳过路上的坑。 </p>
</blockquote>
<h3 id="leetcode-链接"><a href="#leetcode-链接" class="headerlink" title="leetcode 链接"></a>leetcode 链接</h3><ul>
<li><a href="https://discuss.leetcode.com/topic/8232/11-line-simple-java-solution-o-n-with-explanation" target="_blank" rel="external">https://discuss.leetcode.com/topic/8232/11-line-simple-java-solution-o-n-with-explanation</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2015/05/27/YII-start-install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/05/27/YII-start-install/" itemprop="url">Yii 学习笔记: 安装</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-05-27T10:40:33+08:00">
                2015-05-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/php/" itemprop="url" rel="index">
                    <span itemprop="name">php</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>#参考<br><a href="http://www.yiichina.com/doc/guide/2.0/start-installation" target="_blank" rel="external">Yii中文文档</a><br><a href="http://xrong.net/2014/09/20/%E5%9B%BD%E5%86%85%E4%BD%BF%E7%94%A8composer%E7%9A%84%E6%AD%A3%E7%A1%AE%E5%A7%BF%E5%8A%BF/" target="_blank" rel="external">配置composer</a></p>
<p>composer是php的包管理工具 yii的项目也可通过它去初始化 由于要获取github上的项目 在国内不配置代理或镜像很卡 </p>
<p>为了愉快的敲代码 首先就先把这个composer干掉<br>我用的是window下的git bash 这个里面集成了很多linux下的shell命令 简单方便<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ composer<span class="built_in"> config </span>-l -g | grep home</div><div class="line">[home] C:/Users/Administrator/AppData/Roaming/Composer</div></pre></td></tr></table></figure></p>
<p>-l是list的缩写 -g是global的缩写 即列出全局的配置信息 然后我们筛选得到home这一项 这个就是composer的工作目录 配置文件 以及全局的安装都会存在这里</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ composer<span class="built_in"> config </span>-e -g</div></pre></td></tr></table></figure>
<p>这条命令将会用户编辑器打开全局的配置文件<br>将配置文件修改为<br><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    </div><div class="line">	<span class="attr">"config"</span>: &#123;</div><div class="line">	&#125;,</div><div class="line">	<span class="attr">"repositories"</span>: [</div><div class="line">        	&#123;<span class="attr">"type"</span>: <span class="string">"composer"</span>, <span class="attr">"url"</span>: <span class="string">"http://pkg.phpcomposer.com/repo/packagist/"</span>&#125;,</div><div class="line">        	&#123;<span class="attr">"packagist"</span>: <span class="literal">false</span>&#125;</div><div class="line">    	]</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>开始安装第一个全局的composer插件 composer-asset-plugin 这个插件用于管理一些前台包 如css js  框架等</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ composer <span class="meta">global</span> <span class="meta">require</span> <span class="string">"fxp/composer-asset-plugin:~1.0.0"</span></div></pre></td></tr></table></figure>
<p>~号的意思是 大于1.0版本但小于2.0版本的软件包</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://www.pengling.cc/2015/05/07/apache-config-error/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="彭领">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="彭领的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2015/05/07/apache-config-error/" itemprop="url">window下查看 apache 配置文件错误</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-05-07T15:20:44+08:00">
                2015-05-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/apache/" itemprop="url" rel="index">
                    <span itemprop="name">apache</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Windows下修改Apache配置文件 导致服务没法启动了 但是从错误日志里却看不到错误信息 后百度到是可以从dos启动Apache然后看报错信息<br>具体命令如下<br><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">D:<span class="symbol">\w</span>amp<span class="symbol">\b</span>in<span class="symbol">\a</span>pache<span class="symbol">\a</span>pache2.4.9&gt;bin<span class="symbol">\h</span>ttpd.exe -w -k restart -n wampapache64</div></pre></td></tr></table></figure></p>
<ul>
<li>-w 的作用是在控制台中输出错误信息</li>
<li>-k restart 是一体的 表示重启apache</li>
<li>-n 是Apache服务的名字这个是个要注意的地方 如果不填他会按默认的名字去启动 但是很多集成环境他已经改了服务的名字了 这个可以从计算机管理里的服务中看到真实的名字</li>
</ul>
<p>更具体的说明 可以结合-h查看</p>
<p>终于看到报错信息了<br><figure class="highlight routeros"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">AH00526: Syntax <span class="builtin-name">error</span> on line 28 of D:/wamp/bin/apache/apache2.4.9/conf/extra/httpd-vhosts.conf:</div><div class="line">RewriteBase: only valid <span class="keyword">in</span> per-directory<span class="built_in"> config </span>files<span class="built_in"></span></div><div class="line">Note the errors <span class="keyword">or</span> messages above, <span class="keyword">and</span> press the &lt;ESC&gt; key <span class="keyword">to</span> exit.  0<span class="built_in">..</span><span class="built_in">..</span></div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/img/avatar.png"
               alt="彭领" />
          <p class="site-author-name" itemprop="name">彭领</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2014 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">彭领</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.1"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
